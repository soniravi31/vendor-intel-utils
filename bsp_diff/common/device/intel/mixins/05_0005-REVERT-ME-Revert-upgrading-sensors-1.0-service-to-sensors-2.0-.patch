From 8ee6b8b25e8ff925506c8be826e0f128d6f422c8 Mon Sep 17 00:00:00 2001
From: svenate <salini.venate@intel.com>
Date: Tue, 19 Jul 2022 08:42:46 +0530
Subject: [PATCH] Revert "upgrading sensors@1.0-service to sensors@2.0-service
 in Android_S"

This reverts commit 72c432b60568a03f6c5f76a2ae80dce2fd8d9f4d.
---
 groups/device-specific/caas/framework_manifest.xml | 12 +++++++++---
 groups/device-specific/caas/manifest.xml           | 10 ++++++++++
 groups/sensors/mediation/BoardConfig.mk            |  4 ----
 groups/sensors/mediation/option.spec               |  2 --
 groups/sensors/mediation/product.mk                |  8 +++++---
 5 files changed, 24 insertions(+), 12 deletions(-)
 delete mode 100644 groups/sensors/mediation/option.spec

diff --git a/groups/device-specific/caas/framework_manifest.xml b/groups/device-specific/caas/framework_manifest.xml
index ec28769..1cae465 100644
--- a/groups/device-specific/caas/framework_manifest.xml
+++ b/groups/device-specific/caas/framework_manifest.xml
@@ -184,7 +184,13 @@
             <instance>default</instance>
         </interface>
     </hal>
-    <vendor-ndk>
-        <version>31</version>
-    </vendor-ndk>
+    <hal format="hidl">
+        <name>android.hardware.sensors</name>
+        <transport>hwbinder</transport>
+        <version>1.0</version>
+        <interface>
+            <name>ISensors</name>
+            <instance>default</instance>
+        </interface>
+    </hal>
 </manifest>
diff --git a/groups/device-specific/caas/manifest.xml b/groups/device-specific/caas/manifest.xml
index d756376..48aff94 100644
--- a/groups/device-specific/caas/manifest.xml
+++ b/groups/device-specific/caas/manifest.xml
@@ -152,6 +152,16 @@
             <instance>default</instance>
         </interface>
     </hal>
+    <hal format="hidl">
+        <name>android.hardware.sensors</name>
+        <transport>hwbinder</transport>
+        <version>1.0</version>
+        <interface>
+            <name>ISensors</name>
+            <instance>default</instance>
+        </interface>
+    </hal>
+    <kernel target-level="5"/>
     <sepolicy>
         <version>33.0</version>
     </sepolicy>
diff --git a/groups/sensors/mediation/BoardConfig.mk b/groups/sensors/mediation/BoardConfig.mk
index 0adc828..7f6aba9 100644
--- a/groups/sensors/mediation/BoardConfig.mk
+++ b/groups/sensors/mediation/BoardConfig.mk
@@ -1,7 +1,3 @@
 USE_SENSOR_MEDIATION_HAL := true
 
-SOONG_CONFIG_NAMESPACES += senPlugin
-SOONG_CONFIG_senPlugin  += SENSOR_LIST
-SOONG_CONFIG_senPlugin_SENSOR_LIST := {{enable_sensor_list}}
-
 BOARD_SEPOLICY_DIRS += $(INTEL_PATH_SEPOLICY)/sensors/mediation
diff --git a/groups/sensors/mediation/option.spec b/groups/sensors/mediation/option.spec
deleted file mode 100644
index ff58bdd..0000000
--- a/groups/sensors/mediation/option.spec
+++ /dev/null
@@ -1,2 +0,0 @@
-[defaults]
-enable_sensor_list = true
diff --git a/groups/sensors/mediation/product.mk b/groups/sensors/mediation/product.mk
index 3441167..f2d72e9 100644
--- a/groups/sensors/mediation/product.mk
+++ b/groups/sensors/mediation/product.mk
@@ -4,9 +4,12 @@ endif
 
 # Sensors HAL modules
 PRODUCT_PACKAGES += \
-	android.hardware.sensors@2.0-service.intel
+        sensors.$(TARGET_BOARD_PLATFORM)
+
+PRODUCT_PACKAGES += \
+        android.hardware.sensors@1.0-service \
+        android.hardware.sensors@1.0-impl
 
-{{#enable_sensor_list}}
 PRODUCT_COPY_FILES += \
         frameworks/native/data/etc/android.hardware.sensor.ambient_temperature.xml:vendor/etc/permissions/android.hardware.sensor.ambient_temperature.xml \
         frameworks/native/data/etc/android.hardware.sensor.accelerometer.xml:vendor/etc/permissions/android.hardware.sensor.accelerometer.xml \
@@ -15,4 +18,3 @@ PRODUCT_COPY_FILES += \
         frameworks/native/data/etc/android.hardware.sensor.light.xml:vendor/etc/permissions/android.hardware.sensor.light.xml
 
 AUTO_IN += $(TARGET_DEVICE_DIR)/{{_extra_dir}}/auto_hal.in
-{{/enable_sensor_list}}
-- 
2.17.1

